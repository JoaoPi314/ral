<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/ral-hands-on/libs/highlight/styles/github.min.css"> <link rel=stylesheet  href="/ral-hands-on/css/franklin.css"> <link rel=stylesheet  href="/ral-hands-on/css/pure.css"> <link rel=stylesheet  href="/ral-hands-on/css/side-menu.css"> <style> .franklin-content{padding-left:10%;} @media (min-width: 940px) { .franklin-content {width: 900px; margin-left: 0px; padding-left: 80px;} .header{width: 900px; margin-left: 0px; padding-left: 80px;} } </style> <link rel=icon  href="/ral-hands-on/assets/favicon.png"> <title>The Test</title> <div id=layout > <a href="#menu" id=menuLink  class=menu-link ><span></span></a> <div id=menu > <div class=pure-menu > <a class=pure-menu-heading  href="#">RAL</a> <ul class=pure-menu-list > <li class="pure-menu-item "><a href="/ral-hands-on/" class=pure-menu-link >Introduction</a> <li class="pure-menu-item "><a href="/ral-hands-on/register_block/" class=pure-menu-link >Register Blocks</a> <li class="pure-menu-item "><a href="/ral-hands-on/adapter/" class=pure-menu-link >Adapter</a> <li class="pure-menu-item "><a href="/ral-hands-on/agent/" class=pure-menu-link >The Agent</a> <li class="pure-menu-item "><a href="/ral-hands-on/predictor/" class=pure-menu-link >Predictor</a> <li class="pure-menu-item "><a href="/ral-hands-on/env/" class=pure-menu-link >The Env</a> <li class="pure-menu-item "><a href="/ral-hands-on/breath/" class=pure-menu-link >Take a breath</a> <li class="pure-menu-item "><a href="/ral-hands-on/reg_sequence/" class=pure-menu-link >Reg Sequence</a> <li class="pure-menu-item pure-menu-selected"><a href="/ral-hands-on/test_file/" class=pure-menu-link >The Test</a> <li class="pure-menu-item "><a href="/ral-hands-on/results/" class=pure-menu-link >Results</a> <li class="pure-menu-item "><a href="/ral-hands-on/source_code/" class=pure-menu-link >Source Code</a> </ul> </div> </div> <div id=main > <div class=header > <h1>The Test</h1> <h2>Hands-on to implement a simple UVM ambient with RAL</h2> </div> <div class=franklin-content > <p>If you return to any page that contains the UVM diagram, you will see that the register block is inside the test. So, the first thing that we need to know is how to insert this component at the test file. There are three things we must do:</p> <ol> <li><p>Register block instantiation;</p> <li><p>Register block build;</p> <li><p>Connect the register block map to the predictor map;</p> <li><p>Configure the sequencer and the adapter of the register block map;</p> <li><p>Configure the base address of the register block map &#40;the offsets will be computed considering this value&#41;</p> </ol> <p>These five steps are implemented below &#40;The complete Base test code, and the <code>cthulhu_reg_test</code> is at <a href="/ral-hands-on/source_code/">Source Code</a>&#41;.</p> <pre><code class="verilog hljs"><span class=hljs-keyword >class</span> cthulhu_base_test <span class=hljs-keyword >extends</span> uvm_test;
    `uvm_component_utils(cthulhu_base_test)
    
    cthulhu_environment env;
    cthulhu_reg_block   regmodel;   <span class=hljs-comment >// 1.</span>
  
  
    <span class=hljs-keyword >function</span> <span class=hljs-keyword >new</span>(<span class=hljs-keyword >string</span> name = <span class=hljs-string >&quot;cthulhu_base_test&quot;</span>,uvm_component parent=<span class=hljs-literal >null</span>);
        <span class=hljs-keyword >super</span><span class=hljs-variable >.new</span>(name,parent);
    <span class=hljs-keyword >endfunction</span> : <span class=hljs-keyword >new</span>
  
    
    <span class=hljs-keyword >virtual</span> <span class=hljs-keyword >function</span> <span class=hljs-keyword >void</span> build_phase(uvm_phase phase);
        <span class=hljs-keyword >super</span><span class=hljs-variable >.build_phase</span>(phase);
        regmodel = cthulhu_reg_block::type_id::create(<span class=hljs-string >&quot;regmodel&quot;</span>, <span class=hljs-keyword >this</span>); <span class=hljs-comment >// 2.1</span>
        regmodel<span class=hljs-variable >.build</span>(); <span class=hljs-comment >// 2.2</span>
         
        env = cthulhu_environment::type_id::create(<span class=hljs-string >&quot;env&quot;</span>, <span class=hljs-keyword >this</span>);
    <span class=hljs-keyword >endfunction</span> : build_phase

    
    <span class=hljs-keyword >virtual</span> <span class=hljs-keyword >function</span> <span class=hljs-keyword >void</span> connect_phase(uvm_phase phase);
        <span class=hljs-keyword >super</span><span class=hljs-variable >.connect_phase</span>(phase);
    
        env<span class=hljs-variable >.cthulhu_pred</span><span class=hljs-variable >.map</span> = regmodel<span class=hljs-variable >.reg_map</span>; <span class=hljs-comment >// 3.</span>
        regmodel<span class=hljs-variable >.reg_map</span><span class=hljs-variable >.set_sequencer</span>(<span class=hljs-variable >.sequencer</span>(env<span class=hljs-variable >.cthulhu_agnt</span><span class=hljs-variable >.sequencer</span>), <span class=hljs-variable >.adapter</span>(env<span class=hljs-variable >.cthulhu_agnt</span><span class=hljs-variable >.m_adapter</span>)); <span class=hljs-comment >// 4.</span>
        regmodel<span class=hljs-variable >.default_map</span><span class=hljs-variable >.set_base_addr</span>(<span class=hljs-number >&#x27;h100</span>); <span class=hljs-comment >// 5.</span>
    <span class=hljs-keyword >endfunction</span> : connect_phase
    
    ...
  
<span class=hljs-keyword >endclass</span> : cthulhu_base_test</code></pre> <p>The top file doesn&#39;t contain any RAL component, so you can see it at YOU KNOW WHERE YOU CAN FIND SOURCE CODES. Our UVM diagram is finnaly complete:</p> <p><img src="/ral-hands-on/assets/full_diagram.png" alt="UVM environment" /></p> <div class=page-foot > <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> Jo√£o Pedro Melquiades Gomes. Last modified: February 02, 2023. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> </div> <script src="/ral-hands-on/libs/pure/ui.min.js"></script> <script src="/ral-hands-on/libs/highlight/highlight.min.js"></script> <script>hljs.highlightAll();hljs.configure({tabReplace: ' '});</script>