<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/ral/libs/highlight/styles/github.min.css"> <link rel=stylesheet  href="/ral/css/franklin.css"> <link rel=stylesheet  href="/ral/css/pure.css"> <link rel=stylesheet  href="/ral/css/side-menu.css"> <style> .franklin-content{padding-left:10%;} @media (min-width: 940px) { .franklin-content {width: 900px; margin-left: 0px; padding-left: 80px;} .header{width: 900px; margin-left: 0px; padding-left: 80px;} } </style> <link rel=icon  href="/ral/assets/favicon.png"> <title>The Register Sequence</title> <div id=layout > <a href="#menu" id=menuLink  class=menu-link ><span></span></a> <div id=menu > <div class=pure-menu > <a class=pure-menu-heading  href="#">RAL</a> <ul class=pure-menu-list > <li class="pure-menu-item "><a href="/ral/" class=pure-menu-link >Introduction</a> <li class="pure-menu-item "><a href="/ral/register_block/" class=pure-menu-link >Register Blocks</a> <li class="pure-menu-item "><a href="/ral/adapter/" class=pure-menu-link >Adapter</a> <li class="pure-menu-item "><a href="/ral/agent/" class=pure-menu-link >The Agent</a> <li class="pure-menu-item "><a href="/ral/predictor/" class=pure-menu-link >Predictor</a> <li class="pure-menu-item "><a href="/ral/env/" class=pure-menu-link >The Env</a> <li class="pure-menu-item "><a href="/ral/breath/" class=pure-menu-link >Take a breath</a> <li class="pure-menu-item pure-menu-selected"><a href="/ral/reg_sequence/" class=pure-menu-link >Reg Sequence</a> <li class="pure-menu-item "><a href="/ral/test_file/" class=pure-menu-link >The Test</a> <li class="pure-menu-item "><a href="/ral/results/" class=pure-menu-link >Results</a> <li class="pure-menu-item "><a href="/ral/source_code/" class=pure-menu-link >Source Code</a> </ul> </div> </div> <div id=main > <div class=header > <h1>The Register Sequence</h1> <h2>Hands-on to implement a simple UVM ambient with RAL</h2> </div> <div class=franklin-content > <div class=franklin-toc ><ol><li><a href="#write">write&#40;&#41;</a><li><a href="#read">read&#40;&#41;</a><li><a href="#the_sequence_file">The sequence file</a></ol></div> <h1 id=where_the_magic_happens ><a href="#where_the_magic_happens" class=header-anchor >Where the magic happens</a></h1> <p>Okay, we have our register model, our DUT, our UVM components that aren&#39;t affected by RAL. The only thing that isn&#39;t clear yet is where the magic happens. The following sections will reveal the secrets behind the <code>write&#40;&#41;</code> and <code>read&#40;&#41;</code> functions, and why they are so powerful.</p> <h2 id=write ><a href="#write" class=header-anchor >write&#40;&#41;</a></h2> <p>This function will basically write a given value to the register bank in DUT. It will receive two parameters:</p> <pre><code class="verilog hljs">uvm_status_e status; <span class=hljs-comment >// The output of the function is the status</span>
regmodel<span class=hljs-variable >.ct_life_reg</span><span class=hljs-variable >.write</span>(<span class=hljs-variable >.status</span>(status), <span class=hljs-variable >.value</span>(<span class=hljs-number >8&#x27;hFD</span>));</code></pre> <p>The following function will write the valu 8&#39;hFD into the register in DUT. You may be asking: &quot;How this will be done if we are not passing any address or write command?&quot;. In order to answer this question, let&#39;s see what happens when we call <code>write&#40;&#41;</code>:</p> <ol> <li><p>The first thing that will happen is the creation of an <code>uvm_reg_item</code>object. If you remember the implementation of <code>cthulhu_life_reg</code>, there we specify the fields, the policy access and the size of the register. The address information is stored in <code>cthulhu_reg_block</code>;</p> <li><p>Remember the <code>cthulhu_adapter</code>? It will convert the write operation to a bus transaction;</p> <li><p>The driver will then send the transaction by the interface to DUT;</p> <li><p>The monitor will capture the bus transaction;</p> <li><p>Our explicit predictor will ask our adapter to convert back the bus transaction into a register operation;</p> <li><p>This operation will be converted into an <code>uvm_reg_item</code>;</p> <li><p>This object will update the registers values in our model.</p> </ol> <p>If RAL wasn&#39;t used, we would have to define in our sequence the step by step to perform a write operation, like:</p> <ul> <li><p>Set <code>write_en</code> to 1&#39;b1</p> <li><p>Set <code>addr</code> to &#39;h300</p> <li><p>Set <code>data_w</code> to 8&#39;hFD</p> </ul> <p>Now we can see one of the advantages of using RAL. Let&#39;s go to the <code>read&#40;&#41;</code> operation:</p> <h2 id=read ><a href="#read" class=header-anchor >read&#40;&#41;</a></h2> <p>This function will read a value from the register bank in DUT. Here, the two parameters are output.</p> <pre><code class="verilog hljs">uvm_status_e status;
uvm_reg_data_t incoming_data;
regmodel<span class=hljs-variable >.ct_status_reg</span><span class=hljs-variable >.read</span>(status, incoming_data);</code></pre> <p>Let&#39;s see what the read function does behind the scenes:</p> <ol> <li><p>Creation of an <code>uvm_reg_item</code> object;</p> <li><p>The adapter will convert the read operation into a bus transaction;</p> <li><p>The driver will send the transaction to DUT;</p> <li><p>The monitor will capture the transaction;</p> <li><p>The adapter will convert back the bus transaction into register operation;</p> <li><p>The <code>read&#40;&#41;</code> returns the read value to the caller &#40;<code>incoming_data</code>&#41;;</p> <li><p>The register operation is converted to a <code>uvm_reg_item</code>;</p> <li><p>The register model is updated with the values obtained.</p> </ol> <h2 id=the_sequence_file ><a href="#the_sequence_file" class=header-anchor >The sequence file</a></h2> <p>So, our sequence file to this example will be:</p> <pre><code class="verilog hljs"><span class=hljs-keyword >class</span> cthulhu_reg_sequence <span class=hljs-keyword >extends</span> uvm_sequence;
	`uvm_object_utils(cthulhu_reg_sequence)
	
	cthulhu_reg_block regmodel;
	

	<span class=hljs-keyword >function</span> <span class=hljs-keyword >new</span>(<span class=hljs-keyword >string</span> name = <span class=hljs-string >&quot;cthulhu_reg_sequence&quot;</span>); 
		<span class=hljs-keyword >super</span><span class=hljs-variable >.new</span>(name);    
	<span class=hljs-keyword >endfunction</span>
   
	<span class=hljs-keyword >task</span> body;  
		uvm_status_e   status;
		uvm_reg_data_t incoming;
		
		<span class=hljs-keyword >if</span> (starting_phase != <span class=hljs-literal >null</span>)
			starting_phase<span class=hljs-variable >.raise_objection</span>(<span class=hljs-keyword >this</span>);
		
		<span class=hljs-comment >//Write to the Registers</span>
		regmodel<span class=hljs-variable >.ct_sanity_reg</span><span class=hljs-variable >.write</span>(status, <span class=hljs-number >8</span>&#x27;F5);
		regmodel<span class=hljs-variable >.ct_life_reg</span><span class=hljs-variable >.write</span>(status, <span class=hljs-number >8</span>&#x27;F0);
		
		<span class=hljs-comment >//Read from the registers</span>
		regmodel<span class=hljs-variable >.ct_status_reg</span><span class=hljs-variable >.read</span>(status, incoming);
		
		<span class=hljs-keyword >if</span> (starting_phase != <span class=hljs-literal >null</span>)
			starting_phase<span class=hljs-variable >.drop_objection</span>(<span class=hljs-keyword >this</span>);  
		
	<span class=hljs-keyword >endtask</span>: body
<span class=hljs-keyword >endclass</span> : cthulhu_reg_sequence</code></pre> <p>Here I&#39;m making a sequence that will perform two write operations and then one read operation. It can be changed to any order or how many operations the verifier wants to make.</p> <p><img src="/ral/assets/some_percent_diagram_06.png" alt="UVM diagram" /></p> <div class=page-foot > <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> Jo√£o Pedro Melquiades Gomes. Last modified: December 13, 2022. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> </div> <script src="/ral/libs/pure/ui.min.js"></script> <script src="/ral/libs/highlight/highlight.min.js"></script> <script>hljs.highlightAll();hljs.configure({tabReplace: ' '});</script>